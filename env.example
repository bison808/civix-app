# CITZN Platform Environment Configuration
# Agent Morgan (Database Architecture & Data Relationships Specialist)
# Production-grade database and authentication environment variables

# ========================================
# DATABASE CONFIGURATION (Vercel Postgres)
# ========================================

# Primary database connection (with connection pooling)
POSTGRES_URL="postgres://username:password@hostname:port/database?sslmode=require"

# Prisma-compatible URL (if using Prisma in future)
POSTGRES_PRISMA_URL="postgres://username:password@hostname:port/database?sslmode=require&pgbouncer=true&connect_timeout=15"

# Non-SSL connection (development only)
POSTGRES_URL_NO_SSL="postgres://username:password@hostname:port/database"

# Direct connection without pooling (for migrations)
POSTGRES_URL_NON_POOLING="postgres://username:password@hostname:port/database?sslmode=require"

# Database connection details (extracted by Vercel)
POSTGRES_HOST="hostname"
POSTGRES_USER="username" 
POSTGRES_DATABASE="database"
POSTGRES_PASSWORD="password"
POSTGRES_PORT="5432"

# ========================================
# AUTHENTICATION CONFIGURATION
# ========================================

# NextAuth.js configuration
NEXTAUTH_URL="https://yourdomain.com"
NEXTAUTH_SECRET="your-nextauth-secret-key-here"

# Session configuration
SESSION_SECRET="your-session-secret-key-here"
SESSION_TIMEOUT="86400000"  # 24 hours in milliseconds

# Password requirements
MIN_PASSWORD_LENGTH="12"
REQUIRE_UPPERCASE="true"
REQUIRE_LOWERCASE="true" 
REQUIRE_NUMBERS="true"
REQUIRE_SYMBOLS="true"

# Account lockout settings
MAX_LOGIN_ATTEMPTS="5"
LOCKOUT_DURATION="900000"  # 15 minutes in milliseconds

# Token expiration settings
EMAIL_VERIFICATION_EXPIRES="86400000"  # 24 hours
PASSWORD_RESET_EXPIRES="3600000"       # 1 hour

# ========================================
# RATE LIMITING CONFIGURATION
# ========================================

# Login rate limiting
LOGIN_RATE_LIMIT_ATTEMPTS="5"
LOGIN_RATE_LIMIT_WINDOW="900000"  # 15 minutes

# Password reset rate limiting
PASSWORD_RESET_RATE_LIMIT_ATTEMPTS="3"
PASSWORD_RESET_RATE_LIMIT_WINDOW="3600000"  # 1 hour

# Registration rate limiting
REGISTRATION_RATE_LIMIT_ATTEMPTS="3"
REGISTRATION_RATE_LIMIT_WINDOW="3600000"  # 1 hour

# ========================================
# EMAIL CONFIGURATION
# ========================================

# Email service provider (SendGrid, AWS SES, etc.)
EMAIL_PROVIDER="sendgrid"
EMAIL_API_KEY="your-email-api-key"
EMAIL_FROM="noreply@citzn.com"
EMAIL_FROM_NAME="CITZN Platform"

# Email templates
EMAIL_VERIFICATION_TEMPLATE_ID="verification-template-id"
PASSWORD_RESET_TEMPLATE_ID="password-reset-template-id"
WELCOME_EMAIL_TEMPLATE_ID="welcome-template-id"

# ========================================
# EXTERNAL API CONFIGURATION
# ========================================

# Congress API configuration
CONGRESS_API_KEY="your-congress-api-key"
CONGRESS_API_BASE_URL="https://api.congress.gov/v3"

# OpenStates API configuration  
OPENSTATES_API_KEY="your-openstates-api-key"

# Geocoding service (for ZIP code validation)
GEOCODIO_API_KEY="your-geocodio-api-key"

# ========================================
# SECURITY CONFIGURATION
# ========================================

# CORS settings
CORS_ORIGIN="https://yourdomain.com"
CORS_CREDENTIALS="true"

# CSRF protection
CSRF_SECRET="your-csrf-secret-key"

# Content Security Policy
CSP_ENABLED="true"

# Security headers
HSTS_ENABLED="true"
X_FRAME_OPTIONS="DENY"
X_CONTENT_TYPE_OPTIONS="nosniff"

# ========================================
# MONITORING AND LOGGING
# ========================================

# Database logging level
DATABASE_LOG_LEVEL="info"  # debug, info, warn, error

# Application logging
LOG_LEVEL="info"
LOG_FORMAT="json"

# Error tracking (Sentry, etc.)
SENTRY_DSN="your-sentry-dsn"
SENTRY_ENVIRONMENT="production"

# Analytics
ANALYTICS_ENABLED="true"
ANALYTICS_PROVIDER="plausible"
ANALYTICS_DOMAIN="yourdomain.com"

# ========================================
# PERFORMANCE CONFIGURATION
# ========================================

# Database connection pooling
DB_POOL_MIN_CONNECTIONS="1"
DB_POOL_MAX_CONNECTIONS="20"
DB_POOL_ACQUIRE_TIMEOUT="30000"
DB_POOL_IDLE_TIMEOUT="600000"

# Caching
REDIS_URL="redis://username:password@hostname:port"
CACHE_TTL="3600"  # 1 hour default cache TTL

# ========================================
# BACKUP AND MAINTENANCE
# ========================================

# Backup configuration
BACKUP_ENABLED="true"
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM UTC
BACKUP_RETENTION_DAYS="30"

# Maintenance windows
MAINTENANCE_ENABLED="true"
MAINTENANCE_SCHEDULE="0 3 * * 0"  # Sundays at 3 AM UTC

# ========================================
# FEATURE FLAGS
# ========================================

# Authentication features
ENABLE_EMAIL_VERIFICATION="true"
ENABLE_SOCIAL_LOGIN="false"
ENABLE_TWO_FACTOR_AUTH="false"

# Platform features
ENABLE_BILL_TRACKING="true"
ENABLE_REPRESENTATIVE_CONTACT="true"
ENABLE_VOTING_HISTORY="true"
ENABLE_NOTIFICATIONS="true"

# Development features
ENABLE_DEBUG_MODE="false"
ENABLE_TEST_USERS="false"

# ========================================
# DEVELOPMENT CONFIGURATION
# ========================================

# Development database (local PostgreSQL)
DEV_POSTGRES_URL="postgres://postgres:password@localhost:5432/citzn_dev"

# Development email (console logging)
DEV_EMAIL_PROVIDER="console"

# Development security (relaxed settings)
DEV_SKIP_EMAIL_VERIFICATION="true"
DEV_ALLOW_WEAK_PASSWORDS="false"

# ========================================
# DEPLOYMENT CONFIGURATION
# ========================================

# Environment
NODE_ENV="production"  # development, staging, production

# Domain configuration
DOMAIN="yourdomain.com"
SUBDOMAIN="www"

# CDN configuration
CDN_URL="https://cdn.yourdomain.com"

# SSL/TLS configuration
SSL_ENABLED="true"
TLS_VERSION="1.2"

# ========================================
# COMPLIANCE AND PRIVACY
# ========================================

# Data retention policies
USER_DATA_RETENTION_DAYS="2555"  # 7 years
SESSION_DATA_RETENTION_DAYS="90"
LOG_DATA_RETENTION_DAYS="365"

# Privacy settings
GDPR_ENABLED="true"
CCPA_ENABLED="true"
COOKIE_CONSENT_REQUIRED="true"

# Audit logging
AUDIT_ENABLED="true"
AUDIT_RETENTION_DAYS="2555"  # 7 years